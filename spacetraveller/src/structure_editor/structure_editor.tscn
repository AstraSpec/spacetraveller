[gd_scene load_steps=10 format=3 uid="uid://c7bpkfyb6qvuq"]

[ext_resource type="Script" path="res://src/structure_editor/tile_grid.gd" id="1_7cscp"]
[ext_resource type="Texture2D" uid="uid://bol6seyvcdlfe" path="res://gfx/urizen.png" id="1_fl4b5"]
[ext_resource type="Script" path="res://src/structure_editor/structure_editor.gd" id="1_urqvf"]
[ext_resource type="Texture2D" uid="uid://bquyxpx1t2ei8" path="res://gfx/tile.png" id="2_0s7nb"]
[ext_resource type="Script" path="res://src/ui/view_camera.gd" id="3_usumf"]
[ext_resource type="Script" path="res://src/structure_editor/tools.gd" id="4_6l3wk"]
[ext_resource type="Script" path="res://src/structure_editor/save_window.gd" id="5_dh32f"]
[ext_resource type="Script" path="res://src/structure_editor/db_access.gd" id="5_uujpl"]
[ext_resource type="Script" path="res://src/structure_editor/load_window.gd" id="6_fdwd8"]

[node name="StructureEditor" type="Node2D" node_paths=PackedStringArray("Editor", "Background", "TileIDLabel1", "TileIDLabel2", "TileGrid", "Camera", "SelectionVisual", "ToolOptions")]
script = ExtResource("1_urqvf")
Editor = NodePath("Editor")
Background = NodePath("BG")
TileIDLabel1 = NodePath("Canvas/MarginContainer/AspectRatioContainer/VBoxContainer/TileIDLabel1")
TileIDLabel2 = NodePath("Canvas/MarginContainer/AspectRatioContainer/VBoxContainer/TileIDLabel2")
TileGrid = NodePath("Canvas/MarginContainer/AspectRatioContainer/VBoxContainer/TileGrid")
Camera = NodePath("Camera")
SelectionVisual = NodePath("SelectionVisual")
ToolOptions = NodePath("Canvas/HBoxContainer/ToolOptions")

[node name="BG" type="TextureRect" parent="."]
texture_repeat = 2
offset_right = 13.0
offset_bottom = 13.0
texture = ExtResource("2_0s7nb")
stretch_mode = 1

[node name="Camera" type="Camera2D" parent="."]
script = ExtResource("3_usumf")

[node name="Editor" type="StructureEditor" parent="."]
tilesheet = ExtResource("1_fl4b5")

[node name="DbAccess" type="Node" parent="."]
script = ExtResource("5_uujpl")

[node name="Tools" type="Node" parent="."]
script = ExtResource("4_6l3wk")

[node name="SelectionVisual" type="Line2D" parent="."]
closed = true
width = 2.0

[node name="Canvas" type="CanvasLayer" parent="."]

[node name="Dummy" type="Label" parent="Canvas"]
modulate = Color(1, 1, 1, 0.0117647)
offset_left = 807.0
offset_top = 514.0
offset_right = 1935.0
offset_bottom = 537.0
text = "."

[node name="MarginContainer" type="MarginContainer" parent="Canvas"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 16
theme_override_constants/margin_top = 16
theme_override_constants/margin_right = 16
theme_override_constants/margin_bottom = 16

[node name="AspectRatioContainer" type="AspectRatioContainer" parent="Canvas/MarginContainer"]
layout_mode = 2
ratio = 0.25
alignment_horizontal = 2

[node name="VBoxContainer" type="VBoxContainer" parent="Canvas/MarginContainer/AspectRatioContainer"]
layout_mode = 2

[node name="TileIDLabel1" type="Label" parent="Canvas/MarginContainer/AspectRatioContainer/VBoxContainer"]
layout_mode = 2
text = "Tile chosen: "

[node name="TileIDLabel2" type="Label" parent="Canvas/MarginContainer/AspectRatioContainer/VBoxContainer"]
layout_mode = 2
text = "Tile chosen: "

[node name="ClearButton" type="Button" parent="Canvas/MarginContainer/AspectRatioContainer/VBoxContainer"]
layout_mode = 2
text = "Clear"

[node name="TileGrid" type="GridContainer" parent="Canvas/MarginContainer/AspectRatioContainer/VBoxContainer"]
layout_mode = 2
theme_override_constants/h_separation = 0
theme_override_constants/v_separation = 0
columns = 8
script = ExtResource("1_7cscp")

[node name="HBoxContainer" type="HBoxContainer" parent="Canvas"]
offset_right = 40.0
offset_bottom = 40.0

[node name="MenuBar" type="MenuBar" parent="Canvas/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 0

[node name="File" type="PopupMenu" parent="Canvas/HBoxContainer/MenuBar"]
unresizable = false
item_count = 3
item_0/text = "New"
item_1/text = "Save"
item_1/id = 1
item_2/text = "Load"
item_2/id = 2

[node name="Edit" type="PopupMenu" parent="Canvas/HBoxContainer/MenuBar"]
auto_translate_mode = 1
unresizable = false
item_count = 5
item_0/text = "Pencil"
item_1/text = "Line"
item_1/id = 1
item_2/text = "Eyedropper"
item_2/id = 2
item_3/text = "Fill"
item_3/id = 3
item_4/text = "Selection"
item_4/id = 4

[node name="ToolOptions" type="HBoxContainer" parent="Canvas/HBoxContainer"]
layout_mode = 2

[node name="SaveWindow" type="Window" parent="." node_paths=PackedStringArray("structureEditor", "Editor", "StructureID", "FPButton")]
title = "Save Structure"
initial_position = 1
size = Vector2i(400, 400)
visible = false
popup_window = true
script = ExtResource("5_dh32f")
structureEditor = NodePath("..")
Editor = NodePath("../Editor")
StructureID = NodePath("MarginContainer/VBoxContainer/StructureIDText")
FPButton = NodePath("MarginContainer/VBoxContainer/FPButton")

[node name="MarginContainer" type="MarginContainer" parent="SaveWindow"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 8
theme_override_constants/margin_top = 8
theme_override_constants/margin_right = 8
theme_override_constants/margin_bottom = 8

[node name="VBoxContainer" type="VBoxContainer" parent="SaveWindow/MarginContainer"]
layout_mode = 2
theme_override_constants/separation = 10

[node name="StructureIDLabel" type="Label" parent="SaveWindow/MarginContainer/VBoxContainer"]
modulate = Color(0.67069, 0.67069, 0.67069, 1)
layout_mode = 2
text = "1. Structure ID"

[node name="StructureIDText" type="TextEdit" parent="SaveWindow/MarginContainer/VBoxContainer"]
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
placeholder_text = "ID"

[node name="FPLabel" type="Label" parent="SaveWindow/MarginContainer/VBoxContainer"]
modulate = Color(0.67069, 0.67069, 0.67069, 1)
layout_mode = 2
text = "2. Filepath"

[node name="FPButton" type="Button" parent="SaveWindow/MarginContainer/VBoxContainer"]
layout_mode = 2
alignment = 0

[node name="DefaultFP" type="HBoxContainer" parent="SaveWindow/MarginContainer/VBoxContainer"]
visible = false
layout_mode = 2

[node name="DefaultFPSwitch" type="CheckButton" parent="SaveWindow/MarginContainer/VBoxContainer/DefaultFP"]
visible = false
layout_mode = 2
button_pressed = true

[node name="DefaultFPLabel" type="Label" parent="SaveWindow/MarginContainer/VBoxContainer/DefaultFP"]
visible = false
layout_mode = 2
text = "Default filepath"

[node name="CustomFPText" type="TextEdit" parent="SaveWindow/MarginContainer/VBoxContainer"]
visible = false
custom_minimum_size = Vector2(0, 40)
layout_mode = 2
placeholder_text = "city/houses"
editable = false

[node name="Footer" type="HBoxContainer" parent="SaveWindow/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_horizontal = 8
size_flags_vertical = 10
alignment = 2

[node name="Save" type="Button" parent="SaveWindow/MarginContainer/VBoxContainer/Footer"]
layout_mode = 2
text = "Save"

[node name="Close" type="Button" parent="SaveWindow/MarginContainer/VBoxContainer/Footer"]
layout_mode = 2
text = "Cancel"

[node name="LoadWindow" type="Window" parent="." node_paths=PackedStringArray("structureEditor", "Editor", "LoadContainer", "LoadButton", "DeleteButton")]
auto_translate_mode = 1
title = "Load Structure"
initial_position = 1
size = Vector2i(400, 400)
visible = false
popup_window = true
script = ExtResource("6_fdwd8")
structureEditor = NodePath("..")
Editor = NodePath("../Editor")
LoadContainer = NodePath("MarginContainer/VBoxContainer/LoadContainer")
LoadButton = NodePath("MarginContainer/VBoxContainer/Footer/Load")
DeleteButton = NodePath("MarginContainer/VBoxContainer/Footer/Delete")

[node name="MarginContainer" type="MarginContainer" parent="LoadWindow"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/margin_left = 8
theme_override_constants/margin_top = 8
theme_override_constants/margin_right = 8
theme_override_constants/margin_bottom = 8

[node name="VBoxContainer" type="VBoxContainer" parent="LoadWindow/MarginContainer"]
layout_mode = 2
theme_override_constants/separation = 10

[node name="LoadContainer" type="VBoxContainer" parent="LoadWindow/MarginContainer/VBoxContainer"]
layout_mode = 2

[node name="Footer" type="HBoxContainer" parent="LoadWindow/MarginContainer/VBoxContainer"]
layout_mode = 2
size_flags_horizontal = 8
size_flags_vertical = 10
alignment = 2

[node name="Load" type="Button" parent="LoadWindow/MarginContainer/VBoxContainer/Footer"]
layout_mode = 2
disabled = true
text = "Load"

[node name="Delete" type="Button" parent="LoadWindow/MarginContainer/VBoxContainer/Footer"]
layout_mode = 2
disabled = true
text = "Delete"

[node name="Close" type="Button" parent="LoadWindow/MarginContainer/VBoxContainer/Footer"]
layout_mode = 2
text = "Cancel"

[connection signal="pressed" from="Canvas/MarginContainer/AspectRatioContainer/VBoxContainer/ClearButton" to="." method="_on_clear_button_pressed"]
[connection signal="tile_selected" from="Canvas/MarginContainer/AspectRatioContainer/VBoxContainer/TileGrid" to="." method="_on_tile_grid_tile_selected"]
[connection signal="index_pressed" from="Canvas/HBoxContainer/MenuBar/File" to="." method="_on_file_index_pressed"]
[connection signal="index_pressed" from="Canvas/HBoxContainer/MenuBar/Edit" to="." method="_on_edit_index_pressed"]
[connection signal="close_requested" from="SaveWindow" to="SaveWindow" method="_on_close_requested"]
[connection signal="pressed" from="SaveWindow/MarginContainer/VBoxContainer/FPButton" to="SaveWindow" method="_on_fp_button_pressed"]
[connection signal="pressed" from="SaveWindow/MarginContainer/VBoxContainer/Footer/Save" to="SaveWindow" method="_on_save_pressed"]
[connection signal="pressed" from="SaveWindow/MarginContainer/VBoxContainer/Footer/Close" to="SaveWindow" method="_on_close_pressed"]
[connection signal="close_requested" from="LoadWindow" to="LoadWindow" method="_on_close_requested"]
[connection signal="pressed" from="LoadWindow/MarginContainer/VBoxContainer/Footer/Load" to="LoadWindow" method="_on_load_pressed"]
[connection signal="pressed" from="LoadWindow/MarginContainer/VBoxContainer/Footer/Delete" to="LoadWindow" method="_on_delete_pressed"]
[connection signal="pressed" from="LoadWindow/MarginContainer/VBoxContainer/Footer/Close" to="LoadWindow" method="_on_close_pressed"]
